@page "/"


<MudCard>
    <MudCardHeader>
        <MudText Typo="Typo.h1">Blogentry Creator</MudText>
    </MudCardHeader>
    <MudCardContent>
        <MudPaper>
            <MudText Typo="Typo.h3">@_content.Title</MudText>
            @foreach (var part in _content.ContentParts)
            {
                if(part.Type == Lib.Enums.ContentType.MarkDownText)
                {
                    @(Markdown.ToHtml(part.Content)) 
                }
                else
                {
                    @part.Content
                }
            }
        </MudPaper>
        <MudForm>
            <MudTextField Label="Title" T="string" @bind-Value="_content.Title" Required="true" />
            @foreach (var part in _content.ContentParts)
            {
                <MudSelect T="ContentType">
                    @foreach (var item in ContentType.)
                    {
                        <MudSelectItem>item.ToString()</MudSelectItem>
                    }
                </MudSelect>
                <MudTextField Label="Content" T="string" @bind-Value="part.Content" Required="true" />    
            }
            
        </MudForm>
    </MudCardContent>
    <MudCardActions>
        <Download Filename="@($"{_content.Id}.json")" ToDownload="@_content" />
        <MudButton OnClick="GenerateContentlist">Generate ContentList</MudButton>
        @if(_generated)
        {
            <Download Filename="@($"ContentList.json")" ToDownload="@_indexEntryModel" />
        }
    </MudCardActions>
</MudCard>

@code {
    ContentModel _content = new();
    IndexEntryModel _indexEntryModel;
    bool _generated = false;
    void GenerateContentlist()
    {
        _indexEntryModel = new(_content);
        _generated = true;
    }
}
